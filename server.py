# There is a file named malware_list.txt in our directory from where this program reads all the data.
# The data in this text file mentions all the URL's that are affected with the malwares and are not secured to connect.

#!/usr/bin/python

# Please install requests first if you don't have it: pip install requests
import requests
import hmac
import hashlib
import base64
import time
import re
import ntpath
import json
from flask import request
from flask import make_response

from flask import Flask
app = Flask(__name__)
app.debug = True

@app.route('/urlinfo/1')
def validateURL():

    urlcheck = request.args.get('urlcheck')
    print "hi inside python file"
    print urlcheck
    
    fhand = open ('malware_list.txt')
    lines = fhand.read().split(' , ')
    print lines
    n = len(lines)
#print n
    
#for scan_elements, item in enumerate(lines):
#    print "element %d = %s" % (scan_elements, item)
    
   # URL = raw_input("Enter the Url to visit and Press Enter!")
    
    if urlcheck in lines:
        print 'This URL has malware in it.'
        status = "200"	
    else:
        print 'This URL is totally safe to visit!'
        status = "200Safe"
        
    #response = make_response(status)
    print 'Status is ' + status
    return json.dumps(status)
    
if __name__ == '__main__':
    app.run()
        
    